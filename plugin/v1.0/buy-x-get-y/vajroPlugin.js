var vajroPlugin;(()=>{"use strict";var t={d:(e,r)=>{for(var n in r)t.o(r,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:r[n]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};t.r(e),t.d(e,{getBuyXGetY:()=>a});var r=function(){return r=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var u in e=arguments[r])Object.prototype.hasOwnProperty.call(e,u)&&(t[u]=e[u]);return t},r.apply(this,arguments)},n=function(){return n=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var u in e=arguments[r])Object.prototype.hasOwnProperty.call(e,u)&&(t[u]=e[u]);return t},n.apply(this,arguments)},u=function(t){return t.reduce((function(t,e){var r,u=e.variantId;return n(n({},t),((r={})[u]=e,r))}),{})},i=function(t){return t.reduce((function(t,e){return t[e.variantId]=e,t}),{})},c=function(t,e,r){var n=[];return"include"===r?Object.keys(t).forEach((function(r){e[r]&&n.push(t[r])})):"exclude"===r&&Object.keys(t).forEach((function(r){e[r]||n.push(t[r])})),n},o=function(t){var e=t.lineItems,r=t.includeProducts,n=t.excludeProducts,o=i(e),a=u(r),f=u(n),d=0!==Object.keys(a).length?c(o,a,"include"):[],l=0!==Object.keys(f).length?c(o,f,"exclude"):[];t.includedProductLineItem=0!==d.length?d:void 0,t.excludedProductLineItem=0===d.length&&0!==l.length?l:void 0;var s=d.length?d:l;return 0!==s.length?s:t.lineItems},a=function(t,e){var u=t.cartLineItems,c=(void 0===u?{}:u).lineItems,a=function(t){switch(t.buyOfferType){case"threshold":return function(t){var e=t.getOfferConfig,r=t.getRemovedProductList,n=function(t){var e=o(t),r=0;return e.forEach((function(t){var e=t.unitPrice,n=t.quantity;r+=e*n})),r}(t),u=function(t,e){var r=(t=t.sort((function(t,e){return t.threshold-e.threshold}))).reduce((function(t,r){return r.threshold<=Math.round(e)?t<r?t:r:t}),0);return 0!==r?r:[]}(e,n),i=0!==u.length?function(t,e,r){var n=t.includedProductLineItem,u=t.excludedProductLineItem,i=t.lineItems,c=t.getOfferType,o=e.discount,a=e.getProducts,f=e.getProductQuantity,d=n||u||i;return"percentage"===c?(o>=100&&(o=100),d.forEach((function(t){return t.unitPrice=t.unitPrice-t.unitPrice*(o/100)}))):"amount"===c?o>=r?d.forEach((function(t){return t.unitPrice=0*t.unitPrice})):d.forEach((function(t){return t.unitPrice=t.unitPrice*(1-o/r*100/100)})):"product"===c&&(d=a.map((function(t){return t.quantity=f,t}))),d}(t,u,n):[];return{getSplitDiscount:i,getRemovedProductList:r}}(t);case"collection":break;case"product":default:return{};case"quantity":return function(t){var e=t.getRemovedProductList,r=function(t){for(var e=[],r=t.getOfferType,n=t.getOfferConfig,u=n.buyProducts,c=n.buyProductQuantity,a=n.getProducts,f=n.getProductQuantity,d=n.discount,l=u.map((function(t){return t.variantId})),s=o(t),g=i(s),v=!1,P=0,y=l;P<y.length;P++){var p=y[P],h=(g[p]||{}).quantity;if(!(g[p]&&c<=h)){v=!1;break}v=!0}return v&&(e=a.map((function(t){var e=t.unitPrice;return t.quantity=f,"percentage"===r&&(d>=100&&(d=100),t.unitPrice=f*e-f*e*(d/100)),t}))),e}(t);return{getSplitDiscount:r,getRemovedProductList:e}}(t)}return{}}(function(t,e){var u=t.getOfferType;e="product"!==u?function(t){return t.map((function(t){var e=t.originalUnitPrice,n=t.unitPrice;return e&&e!==n?r(r({},t),{unitPrice:e}):t}))}(e):e;var i="product"===u?function(t){return t.filter((function(t){return"READONLY"===t.lineItemType}))}(e):[];return n(n({},t),{lineItems:e,getRemovedProductList:i})}(e,void 0===c?[]:c));return JSON.stringify(a)};vajroPlugin=e})();
//# sourceMappingURL=vajroPlugin.js.map