{"version":3,"file":"vajroPlugin.js","mappings":"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","sources":["webpack://vajroPlugin/webpack/bootstrap","webpack://vajroPlugin/webpack/runtime/define property getters","webpack://vajroPlugin/webpack/runtime/hasOwnProperty shorthand","webpack://vajroPlugin/webpack/runtime/make namespace object","webpack://vajroPlugin/./src/buy-x-get-y/utils/plugin.utils.ts","webpack://vajroPlugin/./src/index.ts","webpack://vajroPlugin/./src/buy-x-get-y/controller/plugin.controller.ts","webpack://vajroPlugin/./src/buy-x-get-y/service/plugin.core.ts","webpack://vajroPlugin/./src/buy-x-get-y/utils/threshold.utils.ts","webpack://vajroPlugin/./src/buy-x-get-y/utils/quantity.utils.ts"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import { resetLineItemAmount, removeExistingDiscount } from \"./threshold.utils\"\n\nexport const buildInputData = (configSchema: object | any, lineItems: Array<any>): object => {\n\tconst { getOfferType } = configSchema\n\n\tlineItems = getOfferType !== \"product\" ? resetLineItemAmount(lineItems) : lineItems\n\n\tconst getRemovedProductList = getOfferType === \"product\" ? removeExistingDiscount(lineItems) : undefined\n\n\tconst config = { ...configSchema, lineItems, getRemovedProductList }\n\n\treturn config\n}\n\nexport const setKeyInFilterProduct = (product: Array<any>): any => {\n\treturn product.reduce((obj: object, producDetails: any) => {\n\t\tconst { variantId } = producDetails\n\n\t\treturn { ...obj, [variantId]: producDetails }\n\t}, {})\n}\n\nexport const getLineItemsObj = (lineItems: Array<any>): any => {\n\treturn lineItems.reduce((acc: any, lineItem: any) => {\n\t\tconst { variantId } = lineItem\n\n\t\tacc[variantId] = lineItem\n\n\t\treturn acc\n\t}, {})\n}\n\nexport const removeLineItems = (lineItems: any, productObj: any, selection: string): Array<object> => {\n\tconst editedLineItem: any[] = []\n\n\tif (selection === \"include\") {\n\t\tObject.keys(lineItems).forEach((key: any) => {\n\t\t\tif (productObj[key]) editedLineItem.push(lineItems[key])\n\t\t})\n\t} else if (selection === \"exclude\") {\n\t\tObject.keys(lineItems).forEach((key: any) => {\n\t\t\tif (!productObj[key]) editedLineItem.push(lineItems[key])\n\t\t})\n\t}\n\n\treturn editedLineItem\n}\n\nexport const sanitizeLineItems = (data: any): Array<any> => {\n\tconst { lineItems, includeProducts, excludeProducts } = data\n\n\tconst lineItemsObj = getLineItemsObj(lineItems)\n\n\tconst includeProductObj = setKeyInFilterProduct(includeProducts)\n\n\tconst excludedProductObj = setKeyInFilterProduct(excludeProducts)\n\n\tconst includedProductLineItem =\n\t\tObject.keys(includeProductObj).length !== 0 ? removeLineItems(lineItemsObj, includeProductObj, \"include\") : []\n\n\tconst excludedProductLineItem =\n\t\tObject.keys(excludedProductObj).length !== 0 ? removeLineItems(lineItemsObj, excludedProductObj, \"exclude\") : []\n\n\tdata.includedProductLineItem = includedProductLineItem.length !== 0 ? includedProductLineItem : undefined\n\n\tdata.excludedProductLineItem =\n\t\tincludedProductLineItem.length === 0 && excludedProductLineItem.length !== 0\n\t\t\t? excludedProductLineItem\n\t\t\t: undefined\n\n\tconst lineItem = includedProductLineItem.length ? includedProductLineItem : excludedProductLineItem\n\n\tconst finalLineItems = lineItem.length !== 0 ? lineItem : data.lineItems\n\n\treturn finalLineItems\n}\n","import { findOfferSection } from \"./buy-x-get-y/controller/plugin.controller\"\nimport { buildInputData } from \"./buy-x-get-y/utils/plugin.utils\"\n\nexport const getBuyXGetY = (appContext: object | any, configSchema: object): string => {\n\tconst { cartLineItems = {} } = appContext\n\n\tconst { lineItems = [] } = cartLineItems\n\n\tconst getBuildInputData = buildInputData(configSchema, lineItems)\n\n\tconst getOfferSection = findOfferSection(getBuildInputData)\n\n\treturn JSON.stringify(getOfferSection)\n}\n","import { thresholdProcess, productProcess, quantityProcess } from \"../service/plugin.core\"\n\nexport const findOfferSection = (data: any): object => {\n\tswitch (data.buyOfferType) {\n\t\tcase \"threshold\":\n\t\t\treturn thresholdProcess(data)\n\n\t\tcase \"collection\":\n\t\t\tbreak\n\n\t\tcase \"product\":\n\t\t\treturn productProcess(data)\n\n\t\tcase \"quantity\":\n\t\t\treturn quantityProcess(data)\n\n\t\tdefault:\n\t\t\treturn {}\n\t}\n\n\treturn {}\n}\n","import { findCartQuantity } from \"../utils/quantity.utils\"\nimport { findCartTotal, findOffer, splitDiscount } from \"../utils/threshold.utils\"\n\nexport const thresholdProcess = (data: any): object => {\n\tconst { getOfferConfig, getRemovedProductList } = data\n\n\tconst getCartTotal = findCartTotal(data)\n\n\tconst getOffer = findOffer(getOfferConfig, getCartTotal)\n\n\tconst getSplitDiscount = getOffer.length !== 0 ? splitDiscount(data, getOffer, getCartTotal) : []\n\n\tconst parsedSplitDiscount = { getSplitDiscount, getRemovedProductList }\n\n\treturn parsedSplitDiscount\n}\n\nexport const productProcess = (data: any): object => {\n\treturn {}\n}\n\nexport const quantityProcess = (data: any): object => {\n\tconst { getRemovedProductList } = data\n\n\tconst getSplitDiscount = findCartQuantity(data)\n\n\tconst parsedSplitDiscount = { getSplitDiscount, getRemovedProductList }\n\n\treturn parsedSplitDiscount\n}\n","import { sanitizeLineItems } from \"./plugin.utils\"\n\nexport const resetLineItemAmount = (lineItems: Array<any>): Array<any> => {\n\treturn lineItems.map(lineItem => {\n\t\tconst { originalUnitPrice, unitPrice } = lineItem\n\n\t\tif (originalUnitPrice && originalUnitPrice !== unitPrice)\n\t\t\treturn {\n\t\t\t\t...lineItem,\n\t\t\t\tunitPrice: originalUnitPrice\n\t\t\t}\n\n\t\treturn lineItem\n\t})\n}\n\nexport const removeExistingDiscount = (lineItems: Array<any>): Array<any> => {\n\treturn lineItems.filter((lineItem: any) => {\n\t\tconst { unitPrice, lineItemType } = lineItem\n\n\t\treturn unitPrice === 0 && lineItemType === \"READONLY\"\n\t})\n}\n\nexport const findCartTotal = (data: any): number => {\n\tconst getSanitizeLineItems = sanitizeLineItems(data)\n\n\tlet total = 0\n\n\tgetSanitizeLineItems.forEach((lineItem: any) => {\n\t\tconst { unitPrice, quantity } = lineItem\n\n\t\ttotal += unitPrice * quantity\n\t})\n\n\treturn total\n}\n\nexport const findOffer = (getOfferConfig: Array<any>, getCartTotal: number): Array<any> => {\n\tgetOfferConfig = getOfferConfig.sort((a: any, b: any) => a.threshold - b.threshold)\n\n\tconst closestThreshold = getOfferConfig.reduce((prev: number, current: any) => {\n\t\tif (current.threshold <= Math.round(getCartTotal)) return prev < current ? prev : current\n\t\telse return prev\n\t}, 0)\n\n\treturn closestThreshold !== 0 ? closestThreshold : []\n}\n\nexport const splitDiscount = (data: any, getOffer: any, getCartTotal: number): Array<any> => {\n\tconst { includedProductLineItem, excludedProductLineItem, lineItems, getOfferType } = data\n\n\tlet { discount, getProducts, getProductQuantity } = getOffer\n\n\tlet filteringLineItems = includedProductLineItem || excludedProductLineItem || lineItems\n\n\tif (getOfferType === \"percentage\") {\n\t\tif (discount >= 100) discount = 100\n\t\tfilteringLineItems.forEach((item: any) => (item.unitPrice = item.unitPrice - item.unitPrice * (discount / 100)))\n\t} else if (getOfferType === \"amount\") {\n\t\tif (discount >= getCartTotal) filteringLineItems.forEach((item: any) => (item.unitPrice = item.unitPrice * 0))\n\t\telse\n\t\t\tfilteringLineItems.forEach(\n\t\t\t\t(item: any) => (item.unitPrice = item.unitPrice * (1 - ((discount / getCartTotal) * 100) / 100))\n\t\t\t)\n\t} else if (getOfferType === \"product\") {\n\t\tfilteringLineItems = getProducts.map((key: any) => {\n\t\t\tkey.quantity = getProductQuantity\n\t\t\treturn key\n\t\t})\n\t}\n\n\treturn filteringLineItems\n}\n","import { getLineItemsObj, sanitizeLineItems } from \"./plugin.utils\"\n\nexport const findCartQuantity = (data: any): object => {\n\tlet getOffer: any = []\n\n\tconst { getOfferConfig } = data\n\n\tconst { buyProducts, buyProductQuantity, getProducts, getProductQuantity } = getOfferConfig\n\n\tconst buyProductIdArray = buyProducts.map((product: any) => product.variantId)\n\n\tconst getSanitizeLineItems = sanitizeLineItems(data)\n\n\tconst getLineItems = getLineItemsObj(getSanitizeLineItems)\n\n\tlet offerFlag = false\n\n\tbuyProductIdArray.forEach((key: any) => {\n\t\tconst { quantity } = getLineItems[key]\n\n\t\tif (getLineItems[key] && buyProductQuantity === quantity) offerFlag = true\n\t\telse {\n\t\t\tofferFlag = false\n\t\t\treturn\n\t\t}\n\t})\n\n\tif (offerFlag) {\n\t\tgetOffer = getProducts.map((key: any) => {\n\t\t\tkey.quantity = getProductQuantity\n\t\t\treturn key\n\t\t})\n\t}\n\n\treturn getOffer\n}\n"],"names":["__webpack_require__","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","Symbol","toStringTag","value","setKeyInFilterProduct","product","reduce","producDetails","variantId","getLineItemsObj","lineItems","acc","lineItem","removeLineItems","productObj","selection","editedLineItem","keys","forEach","push","sanitizeLineItems","data","includeProducts","excludeProducts","lineItemsObj","includeProductObj","excludedProductObj","includedProductLineItem","length","excludedProductLineItem","undefined","getBuyXGetY","appContext","configSchema","getOfferSection","buyOfferType","getOfferConfig","getRemovedProductList","getCartTotal","getSanitizeLineItems","total","unitPrice","quantity","findCartTotal","getOffer","closestThreshold","sort","a","b","threshold","prev","current","Math","round","findOffer","getSplitDiscount","getOfferType","discount","getProducts","getProductQuantity","filteringLineItems","item","map","splitDiscount","thresholdProcess","buyProducts","buyProductQuantity","buyProductIdArray","getLineItems","offerFlag","findCartQuantity","quantityProcess","findOfferSection","originalUnitPrice","resetLineItemAmount","filter","lineItemType","removeExistingDiscount","buildInputData","JSON","stringify"],"sourceRoot":""}